<div id="loading" class="overlay hide">
  <img src="https://media0.giphy.com/media/4NpH0k494YKL4oxIeQ/source.gif" alt="loading...">
  <h1 class="load-msg"></h1>
</div>
<div class="container">
  <div class="jumbotron text-center" id="home-jumbotron">
    <h1 class="display-6" id="appTitle">KEBÃ„B</h1>
    <h3 class="lead" id="slogan"><i>A Trivia Experience</i></h3>
    <hr class="my-4">
    <p id="tagline">Gather four friends and click start!</p>
    <div class="container">
      <form id="usernameForm">
        <input id="username" type="text" placeholder="Enter a username" required />

        {{!-- <a id="joinGame" class="btn btn-primary btn-lg" href="/question">Join Game</a> --}}
        <a id="submit" class="waves-effect waves-light btn">Submit</a>
      </form>
    </div>
  </div>
</div>

<script>
  $("#submit").on("click", function (event) {
    event.preventDefault(); 
    let userName = $("#username").val().trim();
    if (userName !== '' && userName.length > 0) {
      var user = {
        username: userName
      }
      $("#loading .load-msg").text(`Loading ${userName} to game. Hold tight.`);
      $("#loading").removeClass("hide");
      
      $.post("/api/user", user, function (response) {
       
        window.localStorage.setItem("gameid", response.gameid);
        window.localStorage.setItem("userid", response.userid);

       if(response.status) {

          $("#loading .load-msg").text("");
          $("#loading").addClass("hide");
          // start game redirect user to question page
          window.location.href = `/play/${response.gameid}`; 
       } else {

          $("#loading .load-msg").text("You are now in queue, waiting for more users to join.");
         // show message waiting for users
         // interval check status of userCount for game by id
       }
      }) 
    }
  })
</script>

{{!-- <script src="../../project2app/public/js/chat.js"></script> --}}